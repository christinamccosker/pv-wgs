[["index.html", "Pv-WGS-Analysis 1 About", " Pv-WGS-Analysis Christina McCosker 2025-03-19 1 About Insert manuscript details here "],["tidy-data-exploratory.html", "2 Tidy Data &amp; Exploratory 2.1 Libraries 2.2 Data 2.3 Descriptive Statistics 2.4 Exclude samples 2.5 Map of Strandings 2.6 Case v Control ~ Factors", " 2 Tidy Data &amp; Exploratory 2.1 Libraries library(sf) library(tidyverse) library(ggplot2) library(gridExtra) library(ggpubr) library(maps) library(ggmosaic) library(janitor) 2.2 Data meta &lt;- read.csv(&quot;Input Files/metadata.csv&quot;) %&gt;% mutate(classification=factor(classification, levels=c(&quot;Non-survivor&quot;, &quot;Survivor&quot;)), condition=gsub(&quot;1&quot;, &quot;Alive&quot;, condition), condition=gsub(&quot;2&quot;, &quot;Fresh Dead&quot;, condition), condition=gsub(&quot;3&quot;, &quot;Mod Decomp&quot;, condition), condition=gsub(&quot;Moderate Decomposition&quot;, &quot;Mod Decomp&quot;, condition), condition=gsub(&quot;Advanced Decomposition&quot;, &quot;Adv Decomp&quot;, condition), condition=factor(condition, levels=c(&quot;Alive&quot;, &quot;Fresh Dead&quot;, &quot;Mod Decomp&quot;, &quot;Adv Decomp&quot;)), age.class=factor(age.class, levels=c(&quot;Pup/Calf&quot;, &quot;Yearling&quot;, &quot;Subadult&quot;, &quot;Adult&quot;, &quot;Unknown&quot;)), seq.run=factor(seq.run, levels=c(&quot;1&quot;, &quot;2&quot;))) write.csv(meta, &quot;Output Files/metadata_tidy.csv&quot;, row.names = FALSE) 2.3 Descriptive Statistics table(meta$coverage) ## ## high low ## 20 87 meta %&gt;% group_by(coverage) %&gt;% summarize(mean = mean(seqdepth)) ## # A tibble: 2 Ã— 2 ## coverage mean ## &lt;chr&gt; &lt;dbl&gt; ## 1 high 57.9 ## 2 low 3.67 2.4 Exclude samples Low read mapping: 40, 74, 77, 106 Low confidence in classification: 79 meta &lt;- meta %&gt;% filter(!sample.no == &quot;40&quot; &amp; !sample.no == &quot;74&quot; &amp; !sample.no == &quot;77&quot; &amp; !sample.no == &quot;79&quot; &amp; !sample.no == &quot;106&quot;) 2.4.1 Sample statistics table(meta$seq.run) ## ## 1 2 ## 49 53 prop.table(table(meta$condition)) ## ## Alive Fresh Dead Mod Decomp Adv Decomp ## 0.666666667 0.235294118 0.088235294 0.009803922 prop.table(table(meta$sex)) ## ## Female Male Unknown ## 0.52941176 0.45098039 0.01960784 prop.table(table(meta$age.class)) ## ## Pup/Calf Yearling Subadult Adult Unknown ## 0.38235294 0.34313725 0.09803922 0.15686275 0.01960784 prop.table(table(meta$classification)) ## ## Non-survivor Survivor ## 0.4607843 0.5392157 prop.table(table(meta$pdv)) ## ## N/A Negative Positive ## 0.1274510 0.5294118 0.3431373 2.5 Map of Strandings usa &lt;- st_as_sf(maps::map(&quot;state&quot;, fill=TRUE, plot =FALSE)) map &lt;- ggplot(usa) + geom_sf() + geom_point(data=meta, aes(x=long, y=lat, color=classification, shape=classification), size=3) + scale_color_manual(values=c(&quot;black&quot;, &quot;#9f7daa&quot;), name=&quot;Classification&quot;) + scale_shape_manual(values=c(16, 18), name=&quot;Classification&quot;) + coord_sf(xlim=c(-67.3,-71.8), ylim=c(41,44.8)) + theme_bw() + theme(panel.grid = element_blank(), text = element_text(size=20), legend.position = &quot;inside&quot;, legend.position.inside = c(0.83,0.09)) + labs(x=NULL, y=NULL) map ggsave(&quot;Figures/strandings-classification_map.jpeg&quot;, map, width = 8, height = 7, units = &quot;in&quot;) 2.6 Case v Control ~ Factors 2.6.1 During/After Outbreak outbreak &lt;- meta %&gt;% select(classification, pdv) %&gt;% mutate(pdv=factor(pdv, levels=c(&quot;Positive&quot;, &quot;Negative&quot;, &quot;N/A&quot;))) %&gt;% ggplot(data=.) + geom_mosaic(aes(x=product(pdv,classification), fill=pdv)) + scale_fill_manual(values=c(&quot;N/A&quot; = &quot;grey&quot;, &quot;Negative&quot; = &quot;#008080&quot;, &quot;Positive&quot; = &quot;#58baba&quot;), name=&quot;PDV&quot;) + scale_y_continuous(labels = scales::percent) + labs(y=&quot;Proportion of Samples&quot;) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.title.x = element_blank(), legend.position=&quot;bottom&quot;, text = element_text(size=10), plot.title = element_text(hjust = 0.5)) outbreak 2.6.2 Sex sex &lt;- meta %&gt;% select(sex, pdv) %&gt;% mutate(pdv=factor(pdv, levels=c(&quot;Positive&quot;, &quot;Negative&quot;, &quot;N/A&quot;))) %&gt;% ggplot(data=.) + geom_mosaic(aes(x=product(pdv,sex), fill=pdv)) + scale_fill_manual(values=c(&quot;N/A&quot; = &quot;grey&quot;, &quot;Negative&quot; = &quot;#008080&quot;, &quot;Positive&quot; = &quot;#58baba&quot;), name=&quot;PDV&quot;) + scale_y_continuous(labels = scales::percent) + labs(y=&quot;Proportion of Samples&quot;) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.title.x = element_blank(), legend.position=&quot;bottom&quot;, text = element_text(size=10), plot.title = element_text(hjust = 0.5)) sex 2.6.3 Age age &lt;- meta %&gt;% select(age.class, pdv) %&gt;% mutate(pdv=factor(pdv, levels=c(&quot;Positive&quot;, &quot;Negative&quot;, &quot;N/A&quot;)), age.class=factor(age.class, levels=c(&quot;Pup/Calf&quot;, &quot;Yearling&quot;, &quot;Subadult&quot;, &quot;Adult&quot;, &quot;Unknown&quot;))) %&gt;% ggplot(data=.) + geom_mosaic(aes(x=product(pdv,age.class), fill=pdv)) + scale_fill_manual(values=c(&quot;N/A&quot; = &quot;grey&quot;, &quot;Negative&quot; = &quot;#008080&quot;, &quot;Positive&quot; = &quot;#58baba&quot;), name=&quot;PDV&quot;) + scale_y_continuous(labels = scales::percent) + labs(y=&quot;Proportion of Samples&quot;) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.title.x = element_blank(), legend.position=&quot;bottom&quot;, text = element_text(size=10), plot.title = element_text(hjust = 0.5)) age "],["pca---high-coverage.html", "3 PCA - High Coverage 3.1 Libraries 3.2 Data 3.3 VCF to GDS 3.4 LD-based SNP Pruning 3.5 PCA 3.6 Relatedness", " 3 PCA - High Coverage 3.1 Libraries library(data.table) library(SNPRelate) library(gdsfmt) library(dplyr) library(ggplot2) library(gridExtra) library(ggrepel) library(kableExtra) library(knitr) 3.2 Data meta &lt;- fread(&quot;Output Files/metadata_tidy.csv&quot;) %&gt;% mutate(seq.id = gsub(&quot;B5GAN&quot;, &quot;&quot;, seq.id)) 3.3 VCF to GDS # Load VCF file and create GDS file # snpgdsVCF2GDS(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/30xSamples_Genotype_nosex_edit.vcf&quot;, # &quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/30xsamples_Genotype.gds&quot;, # method=&quot;biallelic.only&quot;) snpgdsSummary(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/30xSamples_Genotype_nosex.gds&quot;) ## The file name: C:\\Users\\Christina\\OneDrive - University of Maine System\\pv-wgs\\30xsamples_Genotype_nosex.gds ## The total number of samples: 20 ## The total number of SNPs: 3908010 ## SNP genotypes are stored in SNP-major mode (Sample X SNP). geno &lt;- snpgdsOpen(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/30xSamples_Genotype_nosex.gds&quot;) 3.4 LD-based SNP Pruning Recursively removes SNPs within a sliding window based on pairwise genotypic correlation - remove SNPs in linkage disequilibrium with each other. Conducted chromosome by chromosome (SNPs in a chromosome are independent of SNPs on other chromosomes).Generates set of SNPs that are independent of each other. Many SNPs are going to be in LD to each other based on ancestry. Researchers will LD prune to reduce the chance of false-negatives and look for ways to prioritize SNPs within significant GWAS hits to increase the chance of finding something casual. set.seed(1000) snpset &lt;- snpgdsLDpruning(geno, ld.threshold=0.2, autosome.only=FALSE) ## SNP pruning based on LD: ## Excluding 1,086,533 SNPs (monomorphic: TRUE, MAF: 0.005, missing rate: 0.05) ## # of samples: 20 ## # of SNPs: 2,821,477 ## using 1 thread ## sliding window: 500,000 basepairs, Inf SNPs ## |LD| threshold: 0.2 ## method: composite ## Chrom 1: |====================|====================| ## 2.04%, 6,682 / 327,390 (Wed Mar 19 15:59:01 2025) ## Chrom 2: |====================|====================| ## 1.98%, 7,169 / 361,795 (Wed Mar 19 15:59:02 2025) ## Chrom 3: |====================|====================| ## 1.94%, 6,041 / 310,679 (Wed Mar 19 15:59:02 2025) ## Chrom 4: |====================|====================| ## 2.05%, 7,295 / 355,492 (Wed Mar 19 15:59:03 2025) ## Chrom 5: |====================|====================| ## 1.81%, 3,448 / 190,039 (Wed Mar 19 15:59:03 2025) ## Chrom 6: |====================|====================| ## 2.20%, 5,258 / 239,224 (Wed Mar 19 15:59:04 2025) ## Chrom 7: |====================|====================| ## 2.21%, 3,714 / 168,421 (Wed Mar 19 15:59:05 2025) ## Chrom 8: |====================|====================| ## 2.31%, 2,762 / 119,709 (Wed Mar 19 15:59:05 2025) ## Chrom 9: |====================|====================| ## 2.94%, 4,966 / 169,064 (Wed Mar 19 15:59:05 2025) ## Chrom 10: |====================|====================| ## 2.02%, 4,055 / 200,553 (Wed Mar 19 15:59:06 2025) ## Chrom 11: |====================|====================| ## 2.00%, 5,089 / 254,638 (Wed Mar 19 15:59:06 2025) ## Chrom 12: |====================|====================| ## 2.28%, 6,946 / 305,075 (Wed Mar 19 15:59:07 2025) ## Chrom 13: |====================|====================| ## 2.06%, 5,692 / 276,329 (Wed Mar 19 15:59:07 2025) ## Chrom 14: |====================|====================| ## 2.17%, 5,753 / 264,542 (Wed Mar 19 15:59:08 2025) ## Chrom 16: |====================|====================| ## 1.76%, 6,427 / 365,060 (Wed Mar 19 15:59:08 2025) ## 81,297 markers are selected in total. snpset.id &lt;- unlist(unname(snpset)) snpset2 &lt;- snpgdsLDpruning(geno, ld.threshold=0.1, autosome.only=FALSE) ## SNP pruning based on LD: ## Excluding 1,086,533 SNPs (monomorphic: TRUE, MAF: 0.005, missing rate: 0.05) ## # of samples: 20 ## # of SNPs: 2,821,477 ## using 1 thread ## sliding window: 500,000 basepairs, Inf SNPs ## |LD| threshold: 0.1 ## method: composite ## Chrom 1: |====================|====================| ## 2.11%, 6,895 / 327,390 (Wed Mar 19 15:59:15 2025) ## Chrom 2: |====================|====================| ## 2.05%, 7,419 / 361,795 (Wed Mar 19 15:59:15 2025) ## Chrom 3: |====================|====================| ## 2.02%, 6,267 / 310,679 (Wed Mar 19 15:59:16 2025) ## Chrom 4: |====================|====================| ## 2.12%, 7,519 / 355,492 (Wed Mar 19 15:59:16 2025) ## Chrom 5: |====================|====================| ## 1.86%, 3,536 / 190,039 (Wed Mar 19 15:59:17 2025) ## Chrom 6: |====================|====================| ## 2.26%, 5,411 / 239,224 (Wed Mar 19 15:59:17 2025) ## Chrom 7: |====================|====================| ## 2.28%, 3,840 / 168,421 (Wed Mar 19 15:59:18 2025) ## Chrom 8: |====================|====================| ## 2.36%, 2,821 / 119,709 (Wed Mar 19 15:59:18 2025) ## Chrom 9: |====================|====================| ## 2.96%, 4,999 / 169,064 (Wed Mar 19 15:59:18 2025) ## Chrom 10: |====================|====================| ## 2.05%, 4,117 / 200,553 (Wed Mar 19 15:59:19 2025) ## Chrom 11: |====================|====================| ## 2.06%, 5,240 / 254,638 (Wed Mar 19 15:59:19 2025) ## Chrom 12: |====================|====================| ## 2.33%, 7,098 / 305,075 (Wed Mar 19 15:59:20 2025) ## Chrom 13: |====================|====================| ## 2.11%, 5,825 / 276,329 (Wed Mar 19 15:59:20 2025) ## Chrom 14: |====================|====================| ## 2.21%, 5,837 / 264,542 (Wed Mar 19 15:59:21 2025) ## Chrom 16: |====================|====================| ## 1.83%, 6,670 / 365,060 (Wed Mar 19 15:59:21 2025) ## 83,494 markers are selected in total. snpset.id2 &lt;- unlist(unname(snpset2)) snpset3 &lt;- snpgdsLDpruning(geno, ld.threshold=0.5, autosome.only=FALSE) ## SNP pruning based on LD: ## Excluding 1,086,533 SNPs (monomorphic: TRUE, MAF: 0.005, missing rate: 0.05) ## # of samples: 20 ## # of SNPs: 2,821,477 ## using 1 thread ## sliding window: 500,000 basepairs, Inf SNPs ## |LD| threshold: 0.5 ## method: composite ## Chrom 1: |====================|====================| ## 4.11%, 13,448 / 327,390 (Wed Mar 19 15:59:27 2025) ## Chrom 2: |====================|====================| ## 4.09%, 14,799 / 361,795 (Wed Mar 19 15:59:28 2025) ## Chrom 3: |====================|====================| ## 4.07%, 12,641 / 310,679 (Wed Mar 19 15:59:29 2025) ## Chrom 4: |====================|====================| ## 4.18%, 14,845 / 355,492 (Wed Mar 19 15:59:30 2025) ## Chrom 5: |====================|====================| ## 3.94%, 7,494 / 190,039 (Wed Mar 19 15:59:31 2025) ## Chrom 6: |====================|====================| ## 4.45%, 10,653 / 239,224 (Wed Mar 19 15:59:32 2025) ## Chrom 7: |====================|====================| ## 4.51%, 7,601 / 168,421 (Wed Mar 19 15:59:32 2025) ## Chrom 8: |====================|====================| ## 4.50%, 5,391 / 119,709 (Wed Mar 19 15:59:33 2025) ## Chrom 9: |====================|====================| ## 5.04%, 8,524 / 169,064 (Wed Mar 19 15:59:34 2025) ## Chrom 10: |====================|====================| ## 4.16%, 8,339 / 200,553 (Wed Mar 19 15:59:34 2025) ## Chrom 11: |====================|====================| ## 4.16%, 10,582 / 254,638 (Wed Mar 19 15:59:35 2025) ## Chrom 12: |====================|====================| ## 4.42%, 13,487 / 305,075 (Wed Mar 19 15:59:36 2025) ## Chrom 13: |====================|====================| ## 4.24%, 11,711 / 276,329 (Wed Mar 19 15:59:37 2025) ## Chrom 14: |====================|====================| ## 4.23%, 11,181 / 264,542 (Wed Mar 19 15:59:38 2025) ## Chrom 16: |====================|====================| ## 3.81%, 13,903 / 365,060 (Wed Mar 19 15:59:39 2025) ## 164,599 markers are selected in total. snpset.id3 &lt;- unlist(unname(snpset3)) 3.5 PCA 3.5.1 PCA Original 3.5.1.1 Run PCA pca &lt;- snpgdsPCA(geno, snp.id=snpset.id, num.thread=2, autosome.only=FALSE) ## Principal Component Analysis (PCA) on genotypes: ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 81,297 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 2673881 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 15:59:40 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 15:59:40 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 15:59:40 2025 Done. 3.5.1.2 Calculate PC Percent Variation pc.percent &lt;- round(pca$varprop*100, digits=2) head(pc.percent) ## [1] 6.11 5.53 5.49 5.43 5.40 5.37 3.5.1.3 Configure plot data pca_data &lt;- data.frame(sample.id = pca$sample.id, EV1 = pca$eigenvect[,1], EV2 = pca$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) labelx &lt;- paste0(&quot;EV1 (&quot;, pc.percent[1], &quot;%)&quot;, sep=&quot;&quot;) labely &lt;- paste0(&quot;EV1 (&quot;, pc.percent[2], &quot;%)&quot;, sep=&quot;&quot;) 3.5.1.4 Plot Seemingly no structure, but maybe outliers (5, 51, 58) plot &lt;- ggplot(pca_data, aes(x=EV1, y=EV2)) + geom_point(size=2, colour=&quot;slategray&quot;) + labs(x=labelx, y=labely) + geom_text_repel(label=pca_data$sample.no) + theme_bw() + theme(panel.grid=element_blank()) plot 3.5.1.5 Plot PCA ~ Factors classification &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=classification)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) classification pdv &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=pdv)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) pdv sex &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=sex)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) sex age &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=age.class)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;, &quot;magenta&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) age condition &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=condition)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) condition seqrun &lt;- ggplot(pca_data, aes(x=EV1, y=EV2, color=factor(seq.run))) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) seqrun 3.5.2 PCA w/o Outliers After two iterations. First removed 51, 58, then removed 5, 72. 3.5.2.1 Possible outliers outlier_meta &lt;- meta %&gt;% filter(sample.no==&quot;51&quot; | sample.no==&quot;58&quot; | sample.no==&quot;5&quot; | sample.no==&quot;72&quot;) %&gt;% select(!seq.id &amp; !coverage) %&gt;% setNames(., nm=c(&quot;#&quot;, &quot;sample&quot;, &quot;run&quot;, &quot;category&quot;, &quot;strand date&quot;, &quot;lat&quot;, &quot;long&quot;, &quot;condition&quot;, &quot;sex&quot;, &quot;age&quot;, &quot;pdv&quot;, &quot;totaldna&quot;, &quot;seqdepth&quot;)) outlier_meta %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;, font_size=12, position=&quot;center&quot;) # sample run category strand date lat long condition sex age pdv totaldna seqdepth 5 MME-18-568Pv 1 Non-survivor 8/31/2018 43.16199 -70.61980 Alive Male Yearling Positive 1148 58.7219 51 MME-18-120Pv 2 Non-survivor 7/3/2018 43.66643 -70.23860 Alive Female Yearling N/A 1696 58.1716 58 IFAW20-069Pv 2 Survivor 5/7/2020 41.67004 -69.94767 Mod Decomp Female Adult Negative 4200 58.9652 72 MME-19-149Pv 2 Survivor 5/21/2019 43.83349 -69.64360 Alive Male Pup/Calf Positive 4320 58.9553 3.5.2.2 Run PCA samples_outlier &lt;- meta %&gt;% filter(coverage==&quot;high&quot;) %&gt;% filter(!sample.no==&quot;51&quot; &amp; !sample.no==&quot;58&quot; &amp; !sample.no==&quot;5&quot; &amp; !sample.no==&quot;72&quot;) pca_outlier &lt;- snpgdsPCA(geno, snp.id=snpset.id, sample.id=samples_outlier$seq.id, num.thread=2, autosome.only=FALSE) ## Principal Component Analysis (PCA) on genotypes: ## Excluding 11,473 SNPs (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 16 ## # of SNPs: 69,824 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 1782304 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 15:59:46 2025 (internal increment: 81664) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 15:59:46 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 15:59:46 2025 Done. 3.5.2.3 Calculate PC Percent Variation pc.percent_outlier &lt;- round(pca_outlier$varprop*100, digits=2) head(pc.percent_outlier) ## [1] 6.97 6.95 6.88 6.80 6.75 6.73 3.5.2.4 Configure plot data pca_data_outlier &lt;- data.frame(sample.id = pca_outlier$sample.id, EV1 = pca_outlier$eigenvect[,1], EV2 = pca_outlier$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) labelx &lt;- paste0(&quot;EV1 (&quot;, pc.percent_outlier[1], &quot;%)&quot;, sep=&quot;&quot;) labely &lt;- paste0(&quot;EV1 (&quot;, pc.percent_outlier[2], &quot;%)&quot;, sep=&quot;&quot;) 3.5.2.5 Plot Seemingly no structure, but maybe outliers (5, 51, 58) plot_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2)) + geom_point(size=2, colour=&quot;slategray&quot;) + labs(x=labelx, y=labely) + geom_text_repel(label=pca_data_outlier$sample.no) + theme_bw() + theme(panel.grid=element_blank()) plot_outlier 3.5.2.6 Plot PCA ~ Factors classification_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=classification)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) classification_outlier pdv_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=pdv)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) pdv_outlier sex_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=sex)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) sex_outlier age_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=age.class)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;, &quot;magenta&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) age_outlier condition_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=condition)) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) condition_outlier seqrun_outlier &lt;- ggplot(pca_data_outlier, aes(x=EV1, y=EV2, color=factor(seq.run))) + geom_point(size=2) + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) seqrun_outlier 3.5.2.7 Combine plot_outlier grid.arrange(classification_outlier, pdv_outlier, sex_outlier, age_outlier, condition_outlier, seqrun_outlier, ncol=3) 3.5.3 PCA by Chromosome 3.5.3.1 Chromosome 1 pca_chrom1 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;1&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 6,682 SNPs according to chromosome 1 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 6,682 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 224580 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 15:59:56 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 15:59:56 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 15:59:56 2025 Done. chrom1 &lt;- data.frame(sample.id = pca_chrom1$sample.id, EV1 = pca_chrom1$eigenvect[,1], EV2 = pca_chrom1$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom1 &lt;- round(pca_chrom1$varprop*100, digits=2) labelx_chrom1 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom1[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom1 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom1[2], &quot;%)&quot;, sep=&quot;&quot;) chrom1_plot &lt;- ggplot(chrom1, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 1&quot;, x=labelx_chrom1, y=labely_chrom1) + geom_text_repel(label=chrom1$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.2 Chromosome 2 pca_chrom2 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;2&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 7,169 SNPs according to chromosome 2 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 7,169 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 241119 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 15:59:57 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 15:59:57 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 15:59:57 2025 Done. chrom2 &lt;- data.frame(sample.id = pca_chrom2$sample.id, EV1 = pca_chrom2$eigenvect[,1], EV2 = pca_chrom2$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom2 &lt;- round(pca_chrom2$varprop*100, digits=2) labelx_chrom2 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom2[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom2 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom2[2], &quot;%)&quot;, sep=&quot;&quot;) chrom2_plot &lt;- ggplot(chrom2, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 2&quot;, x=labelx_chrom2, y=labely_chrom2) + geom_text_repel(label=chrom2$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.3 Chromosome 3 pca_chrom3 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;3&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 6,041 SNPs according to chromosome 3 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 6,041 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 209503 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 15:59:59 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 15:59:59 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 15:59:59 2025 Done. chrom3 &lt;- data.frame(sample.id = pca_chrom3$sample.id, EV1 = pca_chrom3$eigenvect[,1], EV2 = pca_chrom3$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom3 &lt;- round(pca_chrom3$varprop*100, digits=2) labelx_chrom3 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom3[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom3 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom3[2], &quot;%)&quot;, sep=&quot;&quot;) chrom3_plot &lt;- ggplot(chrom3, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 3&quot;, x=labelx_chrom3, y=labely_chrom3) + geom_text_repel(label=chrom3$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.4 Chromosome 4 pca_chrom4 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;4&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 7,295 SNPs according to chromosome 4 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 7,295 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 245953 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:01 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:01 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:01 2025 Done. chrom4 &lt;- data.frame(sample.id = pca_chrom4$sample.id, EV1 = pca_chrom4$eigenvect[,1], EV2 = pca_chrom4$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom4 &lt;- round(pca_chrom4$varprop*100, digits=2) labelx_chrom4 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom4[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom4 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom4[2], &quot;%)&quot;, sep=&quot;&quot;) chrom4_plot &lt;- ggplot(chrom4, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 4&quot;, x=labelx_chrom4, y=labely_chrom4) + geom_text_repel(label=chrom4$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.5 Chromosome 5 pca_chrom5 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;5&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 3,448 SNPs according to chromosome 5 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 3,448 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 119026 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:02 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:02 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:02 2025 Done. chrom5 &lt;- data.frame(sample.id = pca_chrom5$sample.id, EV1 = pca_chrom5$eigenvect[,1], EV2 = pca_chrom5$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom5 &lt;- round(pca_chrom5$varprop*100, digits=2) labelx_chrom5 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom5[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom5 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom5[2], &quot;%)&quot;, sep=&quot;&quot;) chrom5_plot &lt;- ggplot(chrom5, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 5&quot;, x=labelx_chrom5, y=labely_chrom5) + geom_text_repel(label=chrom5$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.6 Chromosome 6 pca_chrom6 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;6&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 5,258 SNPs according to chromosome 6 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 5,258 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 172351 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:04 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:04 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:04 2025 Done. chrom6 &lt;- data.frame(sample.id = pca_chrom6$sample.id, EV1 = pca_chrom6$eigenvect[,1], EV2 = pca_chrom6$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom6 &lt;- round(pca_chrom6$varprop*100, digits=2) labelx_chrom6 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom6[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom6 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom6[2], &quot;%)&quot;, sep=&quot;&quot;) chrom6_plot &lt;- ggplot(chrom6, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 6&quot;, x=labelx_chrom6, y=labely_chrom6) + geom_text_repel(label=chrom6$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.7 Chromosome 7 pca_chrom7 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;7&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 3,714 SNPs according to chromosome 7 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 3,714 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 118494 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:06 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:06 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:06 2025 Done. chrom7 &lt;- data.frame(sample.id = pca_chrom7$sample.id, EV1 = pca_chrom7$eigenvect[,1], EV2 = pca_chrom7$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom7 &lt;- round(pca_chrom7$varprop*100, digits=2) labelx_chrom7 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom7[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom7 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom7[2], &quot;%)&quot;, sep=&quot;&quot;) chrom7_plot &lt;- ggplot(chrom7, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 7&quot;, x=labelx_chrom7, y=labely_chrom7) + geom_text_repel(label=chrom7$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.8 Chromosome 8 pca_chrom8 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;8&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 2,762 SNPs according to chromosome 8 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 2,762 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 84324 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:08 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:08 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:08 2025 Done. chrom8 &lt;- data.frame(sample.id = pca_chrom8$sample.id, EV1 = pca_chrom8$eigenvect[,1], EV2 = pca_chrom8$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom8 &lt;- round(pca_chrom8$varprop*100, digits=2) labelx_chrom8 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom8[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom8 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom8[2], &quot;%)&quot;, sep=&quot;&quot;) chrom8_plot &lt;- ggplot(chrom8, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 8&quot;, x=labelx_chrom8, y=labely_chrom8) + geom_text_repel(label=chrom8$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.9 Chromosome 9 pca_chrom9 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;9&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 4,966 SNPs according to chromosome 9 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 4,966 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 142246 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:09 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:09 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:09 2025 Done. chrom9 &lt;- data.frame(sample.id = pca_chrom9$sample.id, EV1 = pca_chrom9$eigenvect[,1], EV2 = pca_chrom9$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom9 &lt;- round(pca_chrom9$varprop*100, digits=2) labelx_chrom9 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom9[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom9 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom9[2], &quot;%)&quot;, sep=&quot;&quot;) chrom9_plot &lt;- ggplot(chrom9, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 9&quot;, x=labelx_chrom9, y=labely_chrom9) + geom_text_repel(label=chrom9$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.10 Chromosome 10 pca_chrom10 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;10&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 4,055 SNPs according to chromosome 10 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 4,055 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 133216 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:11 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:11 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:11 2025 Done. chrom10 &lt;- data.frame(sample.id = pca_chrom10$sample.id, EV1 = pca_chrom10$eigenvect[,1], EV2 = pca_chrom10$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom10 &lt;- round(pca_chrom10$varprop*100, digits=2) labelx_chrom10 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom10[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom10 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom10[2], &quot;%)&quot;, sep=&quot;&quot;) chrom10_plot &lt;- ggplot(chrom10, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 10&quot;, x=labelx_chrom10, y=labely_chrom10) + geom_text_repel(label=chrom10$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.11 Chromosome 11 pca_chrom11 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;11&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 5,089 SNPs according to chromosome 11 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 5,089 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 167381 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:12 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:12 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:12 2025 Done. chrom11 &lt;- data.frame(sample.id = pca_chrom11$sample.id, EV1 = pca_chrom11$eigenvect[,1], EV2 = pca_chrom11$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom11 &lt;- round(pca_chrom11$varprop*100, digits=2) labelx_chrom11 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom11[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom11 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom11[2], &quot;%)&quot;, sep=&quot;&quot;) chrom11_plot &lt;- ggplot(chrom11, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 11&quot;, x=labelx_chrom11, y=labely_chrom11) + geom_text_repel(label=chrom11$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.12 Chromosome 12 pca_chrom12 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;12&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 6,946 SNPs according to chromosome 12 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 6,946 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 222110 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:14 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:14 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:14 2025 Done. chrom12 &lt;- data.frame(sample.id = pca_chrom12$sample.id, EV1 = pca_chrom12$eigenvect[,1], EV2 = pca_chrom12$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom12 &lt;- round(pca_chrom12$varprop*100, digits=2) labelx_chrom12 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom12[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom12 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom12[2], &quot;%)&quot;, sep=&quot;&quot;) chrom12_plot &lt;- ggplot(chrom12, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 12&quot;, x=labelx_chrom12, y=labely_chrom12) + geom_text_repel(label=chrom12$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.13 Chromosome 13 pca_chrom13 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;13&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 5,692 SNPs according to chromosome 13 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 5,692 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 187299 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:15 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:15 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:15 2025 Done. chrom13 &lt;- data.frame(sample.id = pca_chrom13$sample.id, EV1 = pca_chrom13$eigenvect[,1], EV2 = pca_chrom13$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom13 &lt;- round(pca_chrom13$varprop*100, digits=2) labelx_chrom13 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom13[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom13 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom13[2], &quot;%)&quot;, sep=&quot;&quot;) chrom13_plot &lt;- ggplot(chrom13, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 13&quot;, x=labelx_chrom13, y=labely_chrom13) + geom_text_repel(label=chrom13$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.14 Chromosome 14 pca_chrom14 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;14&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 5,753 SNPs according to chromosome 14 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 5,753 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 182618 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:17 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:17 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:17 2025 Done. chrom14 &lt;- data.frame(sample.id = pca_chrom14$sample.id, EV1 = pca_chrom14$eigenvect[,1], EV2 = pca_chrom14$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom14 &lt;- round(pca_chrom14$varprop*100, digits=2) labelx_chrom14 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom14[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom14 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom14[2], &quot;%)&quot;, sep=&quot;&quot;) chrom14_plot &lt;- ggplot(chrom14, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 14&quot;, x=labelx_chrom14, y=labely_chrom14) + geom_text_repel(label=chrom14$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) 3.5.3.15 Chromosome 16 pca_chrom16 &lt;- snpgdsPCA(geno, snp.id = snpset.id, num.thread = 2, autosome.only = &quot;16&quot;) ## Principal Component Analysis (PCA) on genotypes: ## Keeping 6,427 SNPs according to chromosome 16 ## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN) ## # of samples: 20 ## # of SNPs: 6,427 ## using 2 threads ## # of principal components: 32 ## PCA: the sum of all selected genotypes (0,1,2) = 223661 ## CPU capabilities: Double-Precision SSE2 ## Wed Mar 19 16:00:18 2025 (internal increment: 65328) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 1s ## Wed Mar 19 16:00:19 2025 Begin (eigenvalues and eigenvectors) ## Wed Mar 19 16:00:19 2025 Done. chrom16 &lt;- data.frame(sample.id = pca_chrom16$sample.id, EV1 = pca_chrom16$eigenvect[,1], EV2 = pca_chrom16$eigenvect[,2], stringsAsFactors = FALSE) %&gt;% merge(., meta, by.x=&quot;sample.id&quot;, by.y=&quot;seq.id&quot;) pc.percent_chrom16 &lt;- round(pca_chrom16$varprop*100, digits=2) labelx_chrom16 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom16[1], &quot;%)&quot;, sep=&quot;&quot;) labely_chrom16 &lt;- paste0(&quot;EV1 (&quot;, pc.percent_chrom16[2], &quot;%)&quot;, sep=&quot;&quot;) chrom16_plot &lt;- ggplot(chrom16, aes(x=EV1, y=EV2)) + geom_point() + labs(title=&quot;Chromosome 15&quot;, x=labelx_chrom16, y=labely_chrom16) + geom_text_repel(label=chrom16$sample.no, max.overlaps=50) + theme_bw() + theme(panel.grid=element_blank(), plot.title = element_text(hjust = 0.5)) chrom16_plot 3.5.3.16 View chrom1_plot chrom2_plot chrom3_plot chrom4_plot chrom5_plot chrom6_plot chrom7_plot chrom8_plot chrom9_plot chrom10_plot chrom11_plot chrom12_plot chrom13_plot chrom14_plot chrom16_plot 3.6 Relatedness Drop SNPs with missing info in &gt;5% individuals. Exclude rare SNPs, &lt;5% MAF. k0 is high for all individuals - no relatedness sample.id &lt;- read.gdsn(index.gdsn(geno, &quot;sample.id&quot;)) ibd &lt;- snpgdsIBDMoM(geno, sample.id=sample.id, snp.id=snpset.id, maf=0.05, missing.rate=0.05, num.thread=2, autosome.only=FALSE) ## IBD analysis (PLINK method of moment) on genotypes: ## Excluding 50,189 SNPs (monomorphic: TRUE, MAF: 0.05, missing rate: 0.05) ## # of samples: 20 ## # of SNPs: 31,108 ## using 2 threads ## PLINK IBD: the sum of all selected genotypes (0,1,2) = 777386 ## Wed Mar 19 16:00:40 2025 (internal increment: 65536) ## [..................................................] 0%, ETC: --- [==================================================] 100%, completed, 0s ## Wed Mar 19 16:00:40 2025 Done. ibd.coeff &lt;- snpgdsIBDSelection(ibd) plot(ibd.coeff$k0, ibd.coeff$k1, xlim=c(0,1), ylim=c(0,1), xlab=&quot;k0&quot;, ylab=&quot;k1&quot;, main=&quot;YRI samples (MoM)&quot;) lines(c(0,1), c(1,0), col=&quot;red&quot;, lty=2) "],["density-plot-filter-metrics.html", "4 Density Plot Filter Metrics 4.1 Libraries 4.2 Data 4.3 Density Plots", " 4 Density Plot Filter Metrics Step 23 of Chromosome Level Workflow Density plots for SNPs based on: QD, FS, SOR, MQ, MQRankSum, ReadPosRankSum 4.1 Libraries library(ggplot2) 4.2 Data filter &lt;- read.table(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/30xSamples_nosex_hardfilter.table&quot;, header=TRUE) 4.3 Density Plots 4.3.1 Metric: QD Filtered out &lt;2 filter$failQD &lt;- grepl(&quot;QD2&quot;, filter$FILTER) # Original Plot qdplot &lt;- ggplot(filter, aes(x=QD)) + geom_density() qdplot ## Warning: Removed 394 rows containing non-finite outside the scale range ## (`stat_density()`). # Pass/Fail QD qdplot2 &lt;- ggplot(filter, aes(x=QD, fill=failQD)) + geom_density() qdplot2 ## Warning: Removed 394 rows containing non-finite outside the scale range ## (`stat_density()`). 4.3.2 Metric: FS Filtered out &gt;60 filter$failFS &lt;- grepl(&quot;FS60&quot;, filter$FILTER) # Original Plot fsplot &lt;- ggplot(filter, aes(x=(FS))) + scale_x_continuous(trans=&quot;log10&quot;) + geom_density() fsplot ## Warning in scale_x_continuous(trans = &quot;log10&quot;): log-10 transformation ## introduced infinite values. ## Warning: Removed 1584982 rows containing non-finite outside the scale ## range (`stat_density()`). # Pass/Fail FS fsplot2 &lt;- ggplot(filter, aes(x=(FS), fill=failFS)) + scale_x_continuous(trans=&quot;log10&quot;) + geom_density() fsplot2 ## Warning in scale_x_continuous(trans = &quot;log10&quot;): log-10 transformation introduced infinite values. ## Removed 1584982 rows containing non-finite outside the scale ## range (`stat_density()`). 4.3.3 Metric: SOR Filtered out &gt;3 filter$failSOR &lt;- grepl(&quot;SOR3&quot;, filter$FILTER) # Original Plot sorplot &lt;- ggplot(filter, aes(x=SOR)) + geom_density() sorplot # Pass/Fail SOR sorplot2 &lt;- ggplot(filter, aes(x=SOR, fill=failSOR)) + geom_density() sorplot2 4.3.4 Metric: MQ Filtered out &lt;40 filter$failMQ &lt;- grepl(&quot;MQ40&quot;, filter$FILTER) # Original Plot mqplot &lt;- ggplot(filter, aes(x=MQ)) + geom_density() mqplot ## Warning: Removed 33 rows containing non-finite outside the scale range ## (`stat_density()`). # Pass/Fail MQ mqplot2 &lt;- ggplot(filter, aes(x=MQ, fill=failMQ)) + geom_density() mqplot2 ## Warning: Removed 33 rows containing non-finite outside the scale range ## (`stat_density()`). 4.3.5 Metric: MQRankSum Filtered out &lt; -12.5 filter$failMQRankSum &lt;- grepl(&quot;MQRankSum-12.5&quot;, filter$FILTER) sum(filter$MQRankSum &gt; 12.5, na.rm = TRUE) # 43 ## [1] 43 sum(filter$MQRankSum &lt; -12.5, na.rm = TRUE) # 330 ## [1] 330 # Original Plot mqrsplot &lt;- ggplot(filter, aes(x=MQRankSum)) + geom_density() mqrsplot ## Warning: Removed 534414 rows containing non-finite outside the scale ## range (`stat_density()`). # Pass/Fail MQRankSum mqrsplot2 &lt;- ggplot(filter, aes(x=MQRankSum, fill=failMQRankSum)) + geom_density() mqrsplot2 ## Warning: Removed 534414 rows containing non-finite outside the scale ## range (`stat_density()`). 4.3.6 Metric: ReadPosRankSum Filtered out &lt; -8 As large values on either end are not good, will filter out variants with RPRS &gt;8 too filter$failReadPosRankSum &lt;- grepl(&quot;ReadPosRankSum-8&quot;, filter$FILTER) sum(filter$ReadPosRankSum &lt; -8, na.rm = TRUE) #130 ## [1] 130 sum(filter$ReadPosRankSum &gt; 8, na.rm = TRUE) # 96 ## [1] 96 # Original Plot rprsplot &lt;- ggplot(filter, aes(x=ReadPosRankSum)) + geom_density() rprsplot ## Warning: Removed 536637 rows containing non-finite outside the scale ## range (`stat_density()`). # Pass/Fail ReadPosRankSum rprsplot2 &lt;- ggplot(filter, aes(x=ReadPosRankSum, fill=failReadPosRankSum)) + geom_density() rprsplot2 ## Warning: Removed 536637 rows containing non-finite outside the scale ## range (`stat_density()`). "],["gwas---rrblup.html", "5 GWAS - rrBLUP 5.1 Libraries 5.2 Data 5.3 Calculating GRM 5.4 Population structure 5.5 Configure data", " 5 GWAS - rrBLUP 5.1 Libraries library(data.table) library(tidyverse) library(rrBLUP) library(qqman) library(factoextra) library(ggfortify) 5.2 Data snp.matrix &lt;- fread(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/allsamples_maf_prune.raw&quot;) %&gt;% rename_with(gsub, pattern = &quot;\\\\_[A-Z]{1}$&quot;, replacement = &quot;&quot;, colnames(.)) snp.info &lt;- fread(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/allsamples_maf_prune.map&quot;) %&gt;% setNames(c(&quot;chr&quot;, &quot;snp&quot;, &quot;cM&quot;, &quot;pos&quot;)) %&gt;% select(!cM) %&gt;% filter(snp %in% colnames(snp.matrix)) meta &lt;- fread(&quot;Output Files/metadata_tidy.csv&quot;) %&gt;% mutate(seq.id = gsub(&quot;B5GAN&quot;, &quot;&quot;, seq.id)) %&gt;% filter(seq.id %in% snp.matrix$IID) 5.3 Calculating GRM SNP calls need to be changed from 0, 1, 2 to -1, 0, 1 (for rrBLUP) x &lt;- snp.matrix[, -c(1:6)] %&gt;% as.matrix() # Change from 0,1,2 to -1,0,1 for rrBLUP x &lt;- x-1 # Row names = sample ID rownames(x) &lt;- snp.matrix$IID grm &lt;- A.mat(x) 5.4 Population structure 5.4.1 Heatmap No obvious clustering of samples heatmap(grm, col=rev(heat.colors(75))) 5.4.2 PCA Again, seemingly no sample clustering pca &lt;- prcomp(grm, scale=TRUE, center=TRUE) # Variance explained by first 8 PCs eigenvalues &lt;- pca$sdev^2 prop &lt;- round((eigenvalues/sum(eigenvalues)*100), 2)[1:8] prop ## [1] 2.72 2.10 1.37 1.27 1.24 1.23 1.21 1.20 fviz_eig(pca, ncp = 8) pca.data &lt;- data.frame( sample = rownames(pca$x), x = pca$x[,1], y = pca$x[,2]) %&gt;% merge(., meta, by.x=&quot;sample&quot;, by.y=&quot;seq.id&quot;) labelx &lt;- paste0(&quot;PC1 (&quot;, prop[1], &quot;%)&quot;, sep=&quot;&quot;) labely &lt;- paste0(&quot;PC2 (&quot;, prop[2], &quot;%)&quot;, sep=&quot;&quot;) ggplot(pca.data, aes(x=x, y=y, col=classification)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ggplot(pca.data, aes(x=x, y=y, col=pdv)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ggplot(pca.data, aes(x=x, y=y, col=sex)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ## Too few points to calculate an ellipse ## Warning: Removed 1 row containing missing values or values outside the ## scale range (`geom_path()`). ggplot(pca.data, aes(x=x, y=y, col=age.class)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;, &quot;magenta&quot;, &quot;black&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ## Too few points to calculate an ellipse ## Warning in MASS::cov.trob(data[, vars]): Probable convergence failure ## Warning in MASS::cov.trob(data[, vars]): Removed 1 row containing missing values or values outside the ## scale range (`geom_path()`). ggplot(pca.data, aes(x=x, y=y, col=condition)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;, &quot;coral&quot;, &quot;magenta&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ## Too few points to calculate an ellipse ## Warning: Removed 1 row containing missing values or values outside the ## scale range (`geom_path()`). ggplot(pca.data, aes(x=x, y=y, col=factor(seq.run))) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) ggplot(pca.data, aes(x=x, y=y, col=coverage)) + geom_point() + stat_ellipse() + scale_color_manual(values=c(&quot;slategray&quot;, &quot;#58baba&quot;)) + labs(x=labelx, y=labely) + theme_bw() + theme(panel.grid=element_blank()) 5.5 Configure data 5.5.1 Create matrix Add marker location and marker dosage snp.info &lt;- bind_cols(snp.info, as.data.frame(t(x))) 5.5.2 Configure phenotype data Non-survivor = 0, Survivor = 1 phenotypes &lt;- meta %&gt;% select(seq.id, classification) %&gt;% setNames(c(&quot;id&quot;, &quot;phenotype&quot;)) %&gt;% mutate(phenotype = ifelse(phenotype==&quot;Non-survivor&quot;, 0, 1)) # Make sure sample ID order matches unique(phenotypes$id == rownames(x)) # no ## [1] TRUE FALSE phenotypes &lt;- phenotypes[order(match(phenotypes$id, rownames(x))), ] unique(phenotypes$id == rownames(grm)) # yes ## [1] TRUE unique(phenotypes$id == rownames(x)) # yes ## [1] TRUE 5.5.3 Configure grm &amp; snp info vec &lt;- colnames(grm) %in% phenotypes$id grm &lt;- grm[vec,vec] snp.info &lt;- as.data.frame(snp.info) snp.info &lt;- snp.info[,c(TRUE,TRUE,TRUE,vec)] 5.5.4 GWAS Model 1: genomic relationship matrix model &lt;- GWAS(pheno = phenotypes, geno = snp.info, K = grm, fixed = NULL, plot = FALSE) ## [1] &quot;GWAS for trait: phenotype&quot; ## [1] &quot;Variance components estimated. Testing markers.&quot; 5.5.5 Extract results Set names to defaults for manhattan plot. GWAS outputs -log10(pvalues), convert to pvalues. Try FDR and Bonferroni p-adjustment methods. gwasResults &lt;- model %&gt;% select(snp, chr, pos, phenotype) %&gt;% setNames(c(&quot;SNP&quot;, &quot;CHR&quot;, &quot;BP&quot;, &quot;logP&quot;)) %&gt;% mutate(CHR = as.numeric(gsub(&quot;HiC_scaffold_&quot;, &quot;&quot;, CHR))) %&gt;% mutate(P = 10^(-(logP)), fdr = p.adjust(P, method = &quot;fdr&quot;), bonf = p.adjust(P, method = &quot;bonferroni&quot;)) write.csv(gwasResults, &quot;Output Files/allsamples_gwas.csv&quot;, row.names = FALSE) 5.5.6 Manhattan Plot # Threshold for significance bf &lt;- (-log10(0.05 / nrow(snp.info))) fdr &lt;- -log10(0.05) # Bonferroni manhattan(gwasResults, suggestiveline=FALSE, col=c(&quot;black&quot;, &quot;grey&quot;), genomewideline = bf, p = &quot;P&quot;, logp = TRUE) # FDR manhattan(gwasResults, suggestiveline=FALSE, col=c(&quot;black&quot;, &quot;grey&quot;), genomewideline = fdr, p = &quot;fdr&quot;, logp = TRUE) "],["fst-based-approach.html", "6 Fst-based Approach 6.1 Libraries 6.2 Data 6.3 Visualize SNP Fst distribution 6.4 Select outlier SNPs", " 6 Fst-based Approach To complement GWAS, conducting Fst test between cases and controls, selecting top 10% of SNPs as likely to be related to disease susceptibility. 6.1 Libraries library(tidyverse) 6.2 Data fst &lt;- read.table(&quot;C:/Users/Christina/OneDrive - University of Maine System/pv-wgs/allsamples.casevcontrol.weir.fst&quot;, header = 1) 6.3 Visualize SNP Fst distribution hist(fst$WEIR_AND_COCKERHAM_FST) 6.4 Select outlier SNPs 6.4.1 Top 10% Outlier = Within top 10% of Fst differentiation ten &lt;- quantile(fst$WEIR_AND_COCKERHAM_FST, probs = c(0.9)) fst &lt;- fst %&gt;% mutate(outlier.10 = ifelse(WEIR_AND_COCKERHAM_FST &gt; ten, &quot;outlier&quot;, &quot;snp&quot;)) nrow(filter(fst, outlier.10 == &quot;outlier&quot;)) ## [1] 14884 ggplot(fst, aes(WEIR_AND_COCKERHAM_FST, fill = outlier.10)) + geom_histogram(binwidth = 0.005) + scale_fill_manual(values = c(&quot;slategray3&quot;, &quot;gray40&quot;)) + labs(x = &quot;FST&quot;) + theme_bw() + theme(panel.grid = element_blank(), legend.position = &quot;none&quot;) 6.4.2 &gt; 5SD sd &lt;- mean(fst$WEIR_AND_COCKERHAM_FST) + 5*sd(fst$WEIR_AND_COCKERHAM_FST) fst &lt;- fst %&gt;% mutate(outlier.sd = ifelse(WEIR_AND_COCKERHAM_FST &gt; sd, &quot;outlier&quot;, &quot;snp&quot;)) nrow(fst %&gt;% filter(outlier.sd == &quot;outlier&quot;)) ## [1] 539 ggplot(fst, aes(WEIR_AND_COCKERHAM_FST, fill = outlier.sd)) + geom_histogram(binwidth = 0.005) + scale_fill_manual(values = c(&quot;slategray3&quot;, &quot;gray40&quot;)) + labs(x = &quot;FST&quot;) + theme_bw() + theme(panel.grid = element_blank(), legend.position = &quot;none&quot;) 6.4.3 Extract SNPs &amp; 600 bp positions fst.10 &lt;- fst %&gt;% filter(outlier.10 == &quot;outlier&quot;) %&gt;% mutate(minbp = POS - 600, maxbp = POS + 600, flank = paste0(CHROM, &quot;:&quot;, minbp, &quot;-&quot;, maxbp, sep = &quot;&quot;)) write.csv(fst.10, &quot;Output Files/allsamples_fst_10_outlierposition.csv&quot;, row.names = FALSE) fst.sd &lt;- fst %&gt;% filter(outlier.sd == &quot;outlier&quot;) %&gt;% mutate(minbp = POS - 600, maxbp = POS + 600, flank = paste0(CHROM, &quot;:&quot;, minbp, &quot;-&quot;, maxbp, sep = &quot;&quot;)) write.csv(fst.sd, &quot;Output Files/allsamples_fst_sd_outlierposition.csv&quot;, row.names = FALSE) "],["snp-annotation.html", "7 SNP Annotation 7.1 Libraries 7.2 Data 7.3 Tidy Harbor seal genes 7.4 FST 5 SD 7.5 GWAS", " 7 SNP Annotation 7.1 Libraries library(reactome.db) ## Loading required package: AnnotationDbi ## Loading required package: stats4 ## Loading required package: BiocGenerics ## ## Attaching package: &#39;BiocGenerics&#39; ## The following object is masked from &#39;package:gridExtra&#39;: ## ## combine ## The following objects are masked from &#39;package:lubridate&#39;: ## ## intersect, setdiff, union ## The following objects are masked from &#39;package:dplyr&#39;: ## ## combine, intersect, setdiff, union ## The following objects are masked from &#39;package:stats&#39;: ## ## IQR, mad, sd, var, xtabs ## The following objects are masked from &#39;package:base&#39;: ## ## anyDuplicated, aperm, append, as.data.frame, basename, cbind, ## colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, ## get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, ## match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, ## Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff, ## table, tapply, union, unique, unsplit, which.max, which.min ## Loading required package: Biobase ## Welcome to Bioconductor ## ## Vignettes contain introductory material; view with ## &#39;browseVignettes()&#39;. To cite Bioconductor, see ## &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;. ## Loading required package: IRanges ## Loading required package: S4Vectors ## ## Attaching package: &#39;S4Vectors&#39; ## The following objects are masked from &#39;package:data.table&#39;: ## ## first, second ## The following objects are masked from &#39;package:lubridate&#39;: ## ## second, second&lt;- ## The following objects are masked from &#39;package:dplyr&#39;: ## ## first, rename ## The following object is masked from &#39;package:tidyr&#39;: ## ## expand ## The following object is masked from &#39;package:utils&#39;: ## ## findMatches ## The following objects are masked from &#39;package:base&#39;: ## ## expand.grid, I, unname ## ## Attaching package: &#39;IRanges&#39; ## The following object is masked from &#39;package:data.table&#39;: ## ## shift ## The following object is masked from &#39;package:lubridate&#39;: ## ## %within% ## The following objects are masked from &#39;package:dplyr&#39;: ## ## collapse, desc, slice ## The following object is masked from &#39;package:purrr&#39;: ## ## reduce ## The following object is masked from &#39;package:grDevices&#39;: ## ## windows ## ## Attaching package: &#39;AnnotationDbi&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## select library(tidyverse) library(data.table) library(WebGestaltR) ## ****************************************** ## * * ## * Welcome to WebGestaltR ! * ## * * ## ****************************************** library(kableExtra) library(biomaRt) library(ReactomePA) ## ## ReactomePA v1.50.0 Learn more at https://yulab-smu.top/contribution-knowledge-mining/ ## ## Please cite: ## ## Guangchuang Yu, Qing-Yu He. ReactomePA: an R/Bioconductor package for ## reactome pathway analysis and visualization. Molecular BioSystems. ## 2016, 12(2):477-479 7.2 Data Read in: SNP gene/exon/cds information gwas_snp &lt;- read.csv(&quot;Output Files/allsamples_gwas.csv&quot;) fst_sd_genes &lt;- fread(&quot;Input Files/allsamples_fst_sd_outlier_genes_snps.txt&quot;) fst_sd_exons &lt;- fread(&quot;Input Files/allsamples_fst_sd_outlier_exons_snps.txt&quot;) fst_sd_cds &lt;- fread(&quot;Input Files/allsamples_fst_sd_outlier_cds_snps.txt&quot;) fst_sd_fst &lt;- read.csv(&quot;Output Files/allsamples_fst_sd_outlierposition.csv&quot;) pv_genes &lt;- fread(&quot;Input Files/GSC_HSeal_1.0_HiC_genes.gff3&quot;) 7.3 Tidy Harbor seal genes pv_genes_tidy &lt;- pv_genes %&gt;% mutate(gene = V9, gene = str_split_fixed(gene, &quot;;&quot;, 5), gene = str_extract(gene[,4], &quot;(?&lt;=to ).*(?=:)&quot;)) %&gt;% filter(!is.na(gene)) 7.4 FST 5 SD 7.4.1 ID genes fst_sd_genes_tidy &lt;- fst_sd_genes %&gt;% mutate(gene = V9, gene = str_split_fixed(gene, &quot;;&quot;, 5), gene = str_extract(gene[,4], &quot;(?&lt;=to ).*(?=:)&quot;)) %&gt;% filter(!is.na(gene)) %&gt;% mutate(classification = ifelse(V4 %in% fst_sd_cds$V4, &quot;cds&quot;, ifelse(V4 %in% fst_sd_exons, &quot;exon&quot;, &quot;gene&quot;))) write.csv(fst_sd_genes_tidy, &quot;Output Files/allsamples_fst_sd_snp_geneid.csv&quot;) 7.4.2 GO Terms go_bp_sd &lt;- WebGestaltR(enrichMethod=&quot;ORA&quot;, organism=&quot;hsapiens&quot;, enrichDatabase=&quot;geneontology_Biological_Process&quot;, interestGene = fst_sd_genes_tidy$gene, interestGeneType = &quot;genesymbol&quot;, referenceGene = pv_genes_tidy$gene, referenceGeneType = &quot;genesymbol&quot;, sigMethod = &quot;fdr&quot;, fdrThr = 0.05, isOutput = FALSE) ## Loading the functional categories... ## Loading the ID list... ## Loading the reference list... ## Performing the enrichment analysis... ## Warning in oraEnrichment(interestGeneList, referenceGeneList, geneSet, minNum = ## minNum, : No significant gene set is identified based on FDR 0.05! go_cc_sd &lt;- WebGestaltR(enrichMethod=&quot;ORA&quot;, organism=&quot;hsapiens&quot;, enrichDatabase=&quot;geneontology_Cellular_Component&quot;, interestGene = fst_sd_genes_tidy$gene, interestGeneType = &quot;genesymbol&quot;, referenceGene = pv_genes_tidy$gene, referenceGeneType = &quot;genesymbol&quot;, sigMethod = &quot;fdr&quot;, fdrThr = 0.05, isOutput = FALSE) ## Loading the functional categories... ## Loading the ID list... ## Loading the reference list... ## Performing the enrichment analysis... ## Warning in oraEnrichment(interestGeneList, referenceGeneList, geneSet, minNum = ## minNum, : No significant gene set is identified based on FDR 0.05! go_mf_sd &lt;- WebGestaltR(enrichMethod=&quot;ORA&quot;, organism=&quot;hsapiens&quot;, enrichDatabase=&quot;geneontology_Molecular_Function&quot;, interestGene = fst_sd_genes_tidy$gene, interestGeneType = &quot;genesymbol&quot;, referenceGene = pv_genes_tidy$gene, referenceGeneType = &quot;genesymbol&quot;, sigMethod = &quot;fdr&quot;, fdrThr = 0.05, isOutput = FALSE) ## Loading the functional categories... ## Loading the ID list... ## Loading the reference list... ## Performing the enrichment analysis... ## Warning in oraEnrichment(interestGeneList, referenceGeneList, geneSet, minNum = ## minNum, : No significant gene set is identified based on FDR 0.05! 7.4.3 KEGG Pathway kegg_sd &lt;- WebGestaltR(enrichMethod = &quot;ORA&quot;, organism = &quot;hsapiens&quot;, enrichDatabase = &quot;pathway_KEGG&quot;, interestGene = fst_sd_genes_tidy$gene, interestGeneType = &quot;genesymbol&quot;, referenceGene = pv_genes_tidy$gene, referenceGeneType = &quot;genesymbol&quot;, minNum = 5, sigMethod = &quot;fdr&quot;, isOutput = FALSE) ## Loading the functional categories... ## Loading the ID list... ## Loading the reference list... ## Performing the enrichment analysis... kegg_sd %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) geneSet description link size overlap expect enrichmentRatio pValue FDR overlapId userId hsa04931 Insulin resistance http://www.kegg.jp/kegg-bin/show_pathway?hsa04931+11001+32+5291+5524+5792+5836 101 6 0.6380715 9.403335 3.45e-05 0.0111415 11001;32;5291;5524;5792;5836 PTPA;ACACB;PTPRF;SLC27A2;PYGL;PIK3CB 7.4.4 Biomart annotation Each gene was manually annotated with Ensembl identifier to query Ensemblâ€™s Biomart snp_ensembl &lt;- read.csv(&quot;Input Files/allsamples_fst_sd_snp_ensemblid.csv&quot;) ensembl &lt;- useEnsembl(biomart = &quot;ensembl&quot;, dataset = &quot;hsapiens_gene_ensembl&quot;, mirror = &quot;useast&quot;) ## Ensembl site unresponsive, trying www mirror filters &lt;- listFilters(ensembl) attributes &lt;- listAttributes(ensembl) 7.4.4.1 Gene Descriptions snp_description &lt;- getBM(attributes = c(&quot;ensembl_gene_id&quot;, &quot;description&quot;), filter = &quot;ensembl_gene_id&quot;, values = snp_ensembl$Ensembl.ID, mart = ensembl, uniqueRows = TRUE) 7.4.4.2 Entrez description snp_entrez_description &lt;- getBM(attributes = c(&quot;ensembl_gene_id&quot;, &quot;entrezgene_description&quot;), filter = &quot;ensembl_gene_id&quot;, values = snp_ensembl$Ensembl.ID, mart = ensembl, uniqueRows = TRUE) snp_entrez_description %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) ensembl_gene_id entrezgene_description ENSG00000004948 calcitonin receptor ENSG00000005206 signal peptide peptidase like 2B ENSG00000006555 tetratricopeptide repeat domain 22 ENSG00000014123 UFM1 specific ligase 1 ENSG00000014216 calpain 1 ENSG00000023697 deoxyribose-phosphate aldolase ENSG00000025800 karyopherin subunit alpha 6 ENSG00000039560 retinoic acid induced 14 ENSG00000048342 coiled-coil and C2 domain containing 2A ENSG00000051382 phosphatidylinositol-4,5-bisphosphate 3-kinase catalytic subunit beta ENSG00000053108 follistatin like 4 ENSG00000064726 BTB domain containing 1 ENSG00000064961 high mobility group 20B ENSG00000065427 lysyl-tRNA synthetase 1 ENSG00000069188 sidekick cell adhesion molecule 2 ENSG00000074603 dipeptidyl peptidase 8 ENSG00000075914 exosome component 7 ENSG00000076555 acetyl-CoA carboxylase beta ENSG00000089199 chromogranin B ENSG00000100485 SOS Ras/Rho guanine nucleotide exchange factor 2 ENSG00000100504 glycogen phosphorylase L ENSG00000103061 solute carrier family 7 member 6 opposite strand ENSG00000104731 kelch domain containing 4 ENSG00000109466 kelch like family member 2 ENSG00000111727 host cell factor C2 ENSG00000113645 WW and C2 domain containing 1 ENSG00000116120 phenylalanyl-tRNA synthetase subunit beta ENSG00000116141 microtubule affinity regulating kinase 1 ENSG00000116198 centrosomal protein 104 ENSG00000116604 myocyte enhancer factor 2D ENSG00000119383 protein phosphatase 2 phosphatase activator ENSG00000119414 protein phosphatase 6 catalytic subunit ENSG00000119844 aftiphilin ENSG00000119979 DENN domain containing 10 ENSG00000120885 clusterin ENSG00000122012 synaptic vesicle glycoprotein 2C ENSG00000123146 adhesion G protein-coupled receptor E5 ENSG00000124571 exportin 5 ENSG00000128342 LIF interleukin 6 family cytokine ENSG00000129993 CBFA2/RUNX1 partner transcriptional co-repressor 3 ENSG00000130382 MLLT1 super elongation complex subunit ENSG00000130560 UBA domain containing 1 ENSG00000132623 ankyrin repeat and EF-hand domain containing 1 ENSG00000133083 doublecortin like kinase 1 ENSG00000133962 cation channel sperm associated auxiliary subunit beta ENSG00000138029 hydroxyacyl-CoA dehydrogenase trifunctional multienzyme complex subunit beta ENSG00000138448 integrin subunit alpha V ENSG00000140284 solute carrier family 27 member 2 ENSG00000141456 proline, glutamate and leucine rich protein 1 ENSG00000142319 solute carrier family 6 member 3 ENSG00000142611 PR/SET domain 16 ENSG00000142949 protein tyrosine phosphatase receptor type F ENSG00000145681 hyaluronan and proteoglycan link protein 1 ENSG00000146005 pleckstrin and Sec7 domain containing 2 ENSG00000147601 telomeric repeat binding factor 1 ENSG00000148498 par-3 family cell polarity regulator ENSG00000148824 mitochondrial ribosome associated GTPase 1 ENSG00000149547 EI24 autophagy associated transmembrane protein ENSG00000150551 LY6/PLAUR domain containing 1 ENSG00000151572 anoctamin 4 ENSG00000152291 trans-golgi network protein 2 ENSG00000152700 secretion associated Ras related GTPase 1B ENSG00000154269 ectonucleotide pyrophosphatase/phosphodiesterase 3 ENSG00000158270 collectin subfamily member 12 ENSG00000158315 rhomboid like 2 ENSG00000158683 polycystin 1 like 1, transient receptor potential channel interacting ENSG00000159398 carboxylesterase 5A ENSG00000159409 CUGBP Elav-like family member 3 ENSG00000162390 acyl-CoA thioesterase 11 ENSG00000162851 transcription factor B2, mitochondrial ENSG00000163636 proteasome 26S subunit, non-ATPase 6 ENSG00000163686 abhydrolase domain containing 6, acylglycerol lipase ENSG00000165392 WRN RecQ like helicase ENSG00000166411 isocitrate dehydrogenase (NAD(+)) 3 catalytic subunit alpha ENSG00000166796 lactate dehydrogenase C ENSG00000167994 RAB3A interacting protein like 1 ENSG00000168038 unc-51 like kinase 4 ENSG00000168676 potassium channel tetramerization domain containing 19 ENSG00000168872 DEAD-box helicase 19A ENSG00000169220 regulator of G protein signaling 14 ENSG00000169994 myosin VIIB ENSG00000172893 7-dehydrocholesterol reductase ENSG00000179820 myeloid associated differentiation marker ENSG00000179919 olfactory receptor family 10 subfamily A member 7 ENSG00000182985 cell adhesion molecule 1 ENSG00000184988 transmembrane protein 106A ENSG00000185963 BICD cargo adaptor 2 ENSG00000186395 keratin 10 ENSG00000186487 myelin transcription factor 1 like ENSG00000188730 von Willebrand factor C domain containing 2 ENSG00000188869 transmembrane channel like 3 ENSG00000196155 pleckstrin homology and RhoGEF domain containing G4 ENSG00000196369 SLIT-ROBO Rho GTPase activating protein 2B ENSG00000196549 membrane metalloendopeptidase ENSG00000197122 SRC proto-oncogene, non-receptor tyrosine kinase ENSG00000198734 coagulation factor V ENSG00000213699 solute carrier family 35 member F6 ENSG00000224383 proline rich 29 7.4.4.3 GO terms snp_go &lt;- getBM(attributes = c(&quot;ensembl_gene_id&quot;, &quot;go_id&quot;, &quot;name_1006&quot;, &quot;definition_1006&quot;, &quot;namespace_1003&quot;), filter = &quot;ensembl_gene_id&quot;, values = snp_ensembl$Ensembl.ID, mart = ensembl, uniqueRows = TRUE) snp_go_tidy &lt;- snp_go %&gt;% group_by(name_1006) %&gt;% summarize(freq = n()) snp_go %&gt;% filter(namespace_1003 == &quot;biological_process&quot;) %&gt;% group_by(name_1006) %&gt;% summarize(freq = n()) %&gt;% filter(freq &gt; 3) %&gt;% ggplot(., aes(x = fct_reorder(name_1006, freq, .desc=TRUE), y = freq)) + geom_col() + theme_bw() + labs(x = &quot;GO Term&quot;, y = &quot;Frequency&quot;) + theme(panel.grid = element_blank()) + coord_flip() snp_go %&gt;% filter(namespace_1003 == &quot;molecular_function&quot;) %&gt;% group_by(name_1006) %&gt;% summarize(freq = n()) %&gt;% filter(freq &gt; 3) %&gt;% ggplot(., aes(x = fct_reorder(name_1006, freq, .desc=TRUE), y = freq)) + geom_col() + theme_bw() + labs(x = &quot;GO Term&quot;, y = &quot;Frequency&quot;) + theme(panel.grid = element_blank()) + coord_flip() snp_go %&gt;% filter(namespace_1003 == &quot;cellular_component&quot;) %&gt;% group_by(name_1006) %&gt;% summarize(freq = n()) %&gt;% filter(freq &gt; 3) %&gt;% ggplot(., aes(x = fct_reorder(name_1006, freq, .desc=TRUE), y = freq)) + geom_col() + theme_bw() + labs(x = &quot;GO Term&quot;, y = &quot;Frequency&quot;) + theme(panel.grid = element_blank()) + coord_flip() 7.4.4.4 Reactome pathways all_reactome &lt;- as.data.frame(reactomePATHID2NAME) snp_reactome &lt;- getBM(attributes = c(&quot;ensembl_gene_id&quot;, &quot;reactome&quot;), filter = &quot;ensembl_gene_id&quot;, values = snp_ensembl$Ensembl.ID, mart = ensembl, uniqueRows = TRUE) %&gt;% filter(!reactome == &quot;&quot;) %&gt;% merge(., all_reactome, by.x = &quot;reactome&quot;, by.y = &quot;DB_ID&quot;) %&gt;% mutate(path_name = gsub(&quot;Homo sapiens: &quot;, &quot;&quot;, path_name)) snp_reactome %&gt;% group_by(path_name) %&gt;% summarize(freq = n()) %&gt;% filter(freq &gt; 3) %&gt;% ggplot(., aes(x = fct_reorder(path_name, freq, .desc=TRUE), y = freq)) + geom_col() + theme_bw() + labs(x = &quot;Reactome Pathway&quot;, y = &quot;Frequeny&quot;) + theme(panel.grid = element_blank()) + coord_flip() 7.4.4.5 Reactome Pathway Over-representation # Convert to entrez gene ID snp_entrez_id &lt;- getBM(attributes = c(&quot;ensembl_gene_id&quot;, &quot;entrezgene_id&quot;), filter = &quot;ensembl_gene_id&quot;, values = snp_ensembl$Ensembl.ID, mart = ensembl, uniqueRows = TRUE) snp_overrep_reactome &lt;- enrichPathway(gene = snp_entrez_id$entrezgene_id, organism = &quot;human&quot;, pvalueCutoff = 0.05, pAdjustMethod = &quot;fdr&quot;, readable = TRUE, universe = pv_genes_tidy$gene, minGSSize = 2)$result ## Loading required package: org.Hs.eg.db ## ## No gene sets have size between 2 and 500 ... ## --&gt; return NULL... 7.4.5 Exonic, CDS Genes 7.4.5.1 Identify genes fst_sd_cds_tidy &lt;- fst_sd_cds %&gt;% merge(., fst_sd_genes_tidy[,c(12:14)], by = &quot;V12&quot;) %&gt;% merge(., snp_ensembl, by.x = &quot;gene&quot;, by.y = &quot;Gene&quot;) fst_sd_exons_tidy &lt;- fst_sd_exons %&gt;% merge(., fst_sd_genes_tidy[,c(12:14)], by = &quot;V12&quot;) %&gt;% merge(., snp_ensembl, by.x = &quot;gene&quot;, by.y = &quot;Gene&quot;) 7.4.5.2 GO terms fst_sd_cds_tidy %&gt;% merge(., snp_go, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% dplyr::select(name_1006, namespace_1003) %&gt;% arrange(namespace_1003) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) name_1006 namespace_1003 autophagy biological_process apoptotic process biological_process negative regulation of cell growth biological_process macroautophagy biological_process nucleus cellular_component cytoplasm cellular_component membrane cellular_component endoplasmic reticulum cellular_component endoplasmic reticulum membrane cellular_component cytosol cellular_component Golgi apparatus cellular_component nuclear membrane cellular_component protein binding molecular_function importin-alpha family protein binding molecular_function fst_sd_exons_tidy %&gt;% filter(!classification == &quot;cds&quot;) %&gt;% merge(., snp_go, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% dplyr::select(name_1006, namespace_1003) %&gt;% filter(!name_1006 == &quot;&quot;) %&gt;% group_by(name_1006, namespace_1003) %&gt;% summarize(freq = n()) %&gt;% arrange(namespace_1003) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) ## `summarise()` has grouped output by &#39;name_1006&#39;. You can ## override using the `.groups` argument. name_1006 namespace_1003 freq DNA-templated transcription biological_process 1 RNA export from nucleus biological_process 1 cell adhesion biological_process 1 cell differentiation biological_process 2 central nervous system development biological_process 1 glial cell differentiation biological_process 1 granulocyte differentiation biological_process 1 intracellular protein transport biological_process 1 membrane protein ectodomain proteolysis biological_process 1 membrane protein intracellular domain proteolysis biological_process 1 membrane protein proteolysis biological_process 1 miRNA metabolic process biological_process 1 monoatomic ion transmembrane transport biological_process 1 muscle organ development biological_process 1 negative regulation of DNA-templated transcription biological_process 1 negative regulation of cell population proliferation biological_process 1 negative regulation of glycolytic process biological_process 1 neurogenesis biological_process 1 positive regulation of neuroblast proliferation biological_process 1 positive regulation of proteasomal ubiquitin-dependent protein catabolic process biological_process 1 pre-miRNA export from nucleus biological_process 1 protein export from nucleus biological_process 1 protein transport biological_process 1 protein ubiquitination biological_process 1 proteolysis biological_process 1 regulation of aerobic respiration biological_process 1 regulation of immune response biological_process 1 regulation of protein binding biological_process 1 regulation of tumor necrosis factor-mediated signaling pathway biological_process 1 regulatory ncRNA-mediated gene silencing biological_process 1 response to hypoxia biological_process 1 skeletal system development biological_process 1 Golgi apparatus cellular_component 2 Golgi membrane cellular_component 2 Golgi-associated vesicle membrane cellular_component 1 P-body cellular_component 1 RISC complex cellular_component 1 RNA nuclear export complex cellular_component 1 actin cytoskeleton cellular_component 1 centrosome cellular_component 1 collagen-containing extracellular matrix cellular_component 1 cytoplasm cellular_component 2 cytoplasmic ribonucleoprotein granule cellular_component 1 cytoplasmic side of endoplasmic reticulum membrane cellular_component 1 cytosol cellular_component 2 endosome cellular_component 1 endosome membrane cellular_component 1 extracellular matrix cellular_component 1 extracellular region cellular_component 1 extracellular space cellular_component 1 lumenal side of endoplasmic reticulum membrane cellular_component 1 lysosomal membrane cellular_component 1 lysosome cellular_component 1 membrane cellular_component 3 nucleolus cellular_component 1 nucleoplasm cellular_component 4 nucleus cellular_component 2 perineuronal net cellular_component 1 plasma membrane cellular_component 2 protein-containing complex cellular_component 1 synapse cellular_component 1 RISC complex binding molecular_function 1 RNA binding molecular_function 1 aspartic endopeptidase activity, intramembrane cleaving molecular_function 1 cullin family protein binding molecular_function 1 extracellular matrix structural constituent conferring compression resistance molecular_function 1 hyaluronic acid binding molecular_function 1 identical protein binding molecular_function 1 mRNA binding molecular_function 1 mechanosensitive monoatomic ion channel activity molecular_function 1 metal ion binding molecular_function 1 nuclear export signal receptor activity molecular_function 1 peptidase activity molecular_function 1 pre-miRNA binding molecular_function 1 protein binding molecular_function 4 protein homodimerization activity molecular_function 1 small GTPase binding molecular_function 1 tRNA binding molecular_function 1 transcription corepressor activity molecular_function 1 7.4.5.3 Reactome Pathways fst_sd_cds_tidy %&gt;% merge(., snp_reactome, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% dplyr::select(reactome, path_name) %&gt;% arrange(path_name) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) reactome path_name NA NA :â€”â€”â€“ :â€”â€”â€” fst_sd_exons_tidy %&gt;% filter(!classification == &quot;cds&quot;) %&gt;% merge(., snp_reactome, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% arrange(path_name) %&gt;% dplyr::select(reactome, path_name) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) reactome path_name R-HSA-1280218 Adaptive Immune System R-HSA-983168 Antigen processing: Ubiquitination &amp; Proteasome degradation R-HSA-983169 Class I MHC mediated antigen processing &amp; presentation R-HSA-73887 Death Receptor Signaling R-HSA-3000178 ECM proteoglycans R-HSA-1474244 Extracellular matrix organization R-HSA-211000 Gene Silencing by RNA R-HSA-74160 Gene expression (Transcription) R-HSA-168256 Immune System R-HSA-392499 Metabolism of proteins R-HSA-203927 MicroRNA (miRNA) biogenesis R-HSA-8951664 Neddylation R-HSA-597592 Post-translational protein modification R-HSA-5357905 Regulation of TNFR1 signaling R-HSA-162582 Signal Transduction R-HSA-75893 TNF signaling 7.5 GWAS gwas_snp &lt;- gwas_snp %&gt;% filter(fdr &lt; 0.05) %&gt;% merge(., fst_sd_genes_tidy, by.x = &quot;BP&quot;, by.y = &quot;V4&quot;) snp_ensembl %&gt;% filter(Gene == &quot;HAPLN1&quot;) %&gt;% merge(., snp_go, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% filter(!name_1006 == &quot;&quot;) %&gt;% arrange(namespace_1003) %&gt;% dplyr::select(name_1006, namespace_1003) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) name_1006 namespace_1003 cell adhesion biological_process central nervous system development biological_process skeletal system development biological_process positive regulation of neuroblast proliferation biological_process glial cell differentiation biological_process extracellular region cellular_component extracellular space cellular_component synapse cellular_component collagen-containing extracellular matrix cellular_component perineuronal net cellular_component extracellular matrix cellular_component hyaluronic acid binding molecular_function extracellular matrix structural constituent conferring compression resistance molecular_function snp_ensembl %&gt;% filter(Gene == &quot;HAPLN1&quot;) %&gt;% merge(., snp_reactome, by.x = &quot;Ensembl.ID&quot;, by.y = &quot;ensembl_gene_id&quot;) %&gt;% kable() %&gt;% kable_styling(&quot;basic&quot;) Ensembl.ID Gene reactome path_name ENSG00000145681 HAPLN1 R-HSA-3000178 ECM proteoglycans ENSG00000145681 HAPLN1 R-HSA-1474244 Extracellular matrix organization HAPLN1: Predicted to enable hyaluronic acid binding activity. Predicted to be an extracellular matrix structural constituent conferring compression resistance. Predicted to be involved in nervous system development; positive regulation of neuroblast proliferation; and skeletal system development. **SNPs in introns that exhibit differences in allele frequency between cases and controls - we say it potentially has some impact on survival. But how does SNP in intronic region impact survivability? Polymorphism &amp; pathway - how do genetic changes affect pathways that affect higher physiological levels? Single gene, large effect - lots of SNPs in a gene "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
